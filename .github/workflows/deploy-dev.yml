# This is a basic workflow to help you get started with Actions

name: Dev Deploy

# Controls when the action will run. Triggers the workflow on push or pull request
# events but only for the master branch
on:
  push:
    branches: [dev]

# Define common variables for all jobs since all use the dokku action
env:
  PRIVATE_KEY: ${{ secrets.PRIVATE_KEY }}
  HOST: spluseins-i.ostfalia.de
  PORT: 8080
  FORCE_DEPLOY: true
  BRANCH: ${{github.ref}}

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  deploy-web-staging:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0 # workaround for dokku
      - name: Deploy with dokku
        uses: vitalyliber/dokku-github-action@v6.1
        env:
          PROJECT: web-staging
  # deploy-api-staging:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - uses: actions/checkout@v2
  #       with:
  #         fetch-depth: 0 # workaround for dokku
  #     - name: Deploy with dokku
  #       uses: vitalyliber/dokku-github-action@v6.1
  #       env:
  #         PROJECT: api-staging
